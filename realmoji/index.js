(function(m,l,f){"use strict";const c=[],{getCustomEmojiById:g}=l.findByStoreName("EmojiStore"),p=l.findByName("RowManager"),a=/https:\/\/cdn.discordapp.com\/emojis\/(\d+)\.\w+/;c.push(f.before("generate",p.prototype,([n])=>{if(n.rowType!==1)return;let e=n.message.content;if(!e?.length)return;const r=e.match(a)?.index;if(r===void 0)return;const s=e.slice(r).trim().split(`
`);if(!s.every(o=>o.match(a)))return;for(e=e.slice(0,r);e.indexOf("  ")!==-1;)e=e.replace("  ",` ${s.shift()} `);e=e.trim(),s.length&&(e+=` ${s.join(" ")}`);const t=n.message.embeds;for(let o=0;o<t.length;o++){const i=t[o];i.type==="image"&&i.url.match(a)&&t.splice(o--,1)}n.message.content=e,n.__realmoji=!0})),c.push(f.after("generate",p.prototype,([n],e)=>{if(n.rowType!==1||n.__realmoji!==!0)return;const{content:r}=e.message;if(!Array.isArray(r))return;const s=r.every(t=>t.type==="link"&&t.target.match(a)||t.type==="text"&&t.content===" ");for(let t=0;t<r.length;t++){const o=r[t];if(o.type!=="link")continue;const i=o.target.match(a);if(!i)continue;const d=`${i[0]}?size=128`,y=g(i[1]);r[t]={type:"customEmoji",id:i[1],alt:y?.name??"<realmoji>",src:d,frozenSrc:d.replace("gif","webp"),jumboable:s?!0:void 0,log_edit:!1,otherPluginBypass:!0}}}));const u=()=>c.forEach(n=>n());return m.onUnload=u,m})({},vendetta.metro,vendetta.patcher);
